(window["webpackJsonp"]=window["webpackJsonp"]||[]).push([["create"],{"0cb2":function(t,e,r){var n=r("7b0b"),a=Math.floor,i="".replace,o=/\$([$&'`]|\d{1,2}|<[^>]*>)/g,s=/\$([$&'`]|\d{1,2})/g;t.exports=function(t,e,r,c,u,l){var f=r+t.length,d=c.length,p=s;return void 0!==u&&(u=n(u),p=o),i.call(l,p,(function(n,i){var o;switch(i.charAt(0)){case"$":return"$";case"&":return t;case"`":return e.slice(0,r);case"'":return e.slice(f);case"<":o=u[i.slice(1,-1)];break;default:var s=+i;if(0===s)return n;if(s>d){var l=a(s/10);return 0===l?n:l<=d?void 0===c[l-1]?i.charAt(1):c[l-1]+i.charAt(1):n}o=c[s-1]}return void 0===o?"":o}))}},1276:function(t,e,r){"use strict";var n=r("d784"),a=r("44e7"),i=r("825a"),o=r("1d80"),s=r("4840"),c=r("8aa5"),u=r("50c4"),l=r("577e"),f=r("14c3"),d=r("9263"),p=r("9f7f"),v=r("d039"),h=p.UNSUPPORTED_Y,m=[].push,g=Math.min,b=4294967295,y=!v((function(){var t=/(?:)/,e=t.exec;t.exec=function(){return e.apply(this,arguments)};var r="ab".split(t);return 2!==r.length||"a"!==r[0]||"b"!==r[1]}));n("split",(function(t,e,r){var n;return n="c"=="abbc".split(/(b)*/)[1]||4!="test".split(/(?:)/,-1).length||2!="ab".split(/(?:ab)*/).length||4!=".".split(/(.?)(.?)/).length||".".split(/()()/).length>1||"".split(/.?/).length?function(t,r){var n=l(o(this)),i=void 0===r?b:r>>>0;if(0===i)return[];if(void 0===t)return[n];if(!a(t))return e.call(n,t,i);var s,c,u,f=[],p=(t.ignoreCase?"i":"")+(t.multiline?"m":"")+(t.unicode?"u":"")+(t.sticky?"y":""),v=0,h=new RegExp(t.source,p+"g");while(s=d.call(h,n)){if(c=h.lastIndex,c>v&&(f.push(n.slice(v,s.index)),s.length>1&&s.index<n.length&&m.apply(f,s.slice(1)),u=s[0].length,v=c,f.length>=i))break;h.lastIndex===s.index&&h.lastIndex++}return v===n.length?!u&&h.test("")||f.push(""):f.push(n.slice(v)),f.length>i?f.slice(0,i):f}:"0".split(void 0,0).length?function(t,r){return void 0===t&&0===r?[]:e.call(this,t,r)}:e,[function(e,r){var a=o(this),i=void 0==e?void 0:e[t];return void 0!==i?i.call(e,a,r):n.call(l(a),e,r)},function(t,a){var o=i(this),d=l(t),p=r(n,o,d,a,n!==e);if(p.done)return p.value;var v=s(o,RegExp),m=o.unicode,y=(o.ignoreCase?"i":"")+(o.multiline?"m":"")+(o.unicode?"u":"")+(h?"g":"y"),w=new v(h?"^(?:"+o.source+")":o,y),$=void 0===a?b:a>>>0;if(0===$)return[];if(0===d.length)return null===f(w,d)?[d]:[];var x=0,A=0,S=[];while(A<d.length){w.lastIndex=h?0:A;var k,O=f(w,h?d.slice(A):d);if(null===O||(k=g(u(w.lastIndex+(h?A:0)),d.length))===x)A=c(d,A,m);else{if(S.push(d.slice(x,A)),S.length===$)return S;for(var _=1;_<=O.length-1;_++)if(S.push(O[_]),S.length===$)return S;A=x=k}}return S.push(d.slice(x)),S}]}),!y,h)},"2c22":function(t,e,r){},"2ca0":function(t,e,r){"use strict";var n=r("23e7"),a=r("06cf").f,i=r("50c4"),o=r("577e"),s=r("5a34"),c=r("1d80"),u=r("ab13"),l=r("c430"),f="".startsWith,d=Math.min,p=u("startsWith"),v=!l&&!p&&!!function(){var t=a(String.prototype,"startsWith");return t&&!t.writable}();n({target:"String",proto:!0,forced:!v&&!p},{startsWith:function(t){var e=o(c(this));s(t);var r=i(d(arguments.length>1?arguments[1]:void 0,e.length)),n=o(t);return f?f.call(e,n,r):e.slice(r,r+n.length)===n}})},3243:function(t,e,r){},4478:function(t,e,r){"use strict";r("2c22")},"44e7":function(t,e,r){var n=r("861d"),a=r("c6b6"),i=r("b622"),o=i("match");t.exports=function(t){var e;return n(t)&&(void 0!==(e=t[o])?!!e:"RegExp"==a(t))}},"4df4":function(t,e,r){"use strict";var n=r("0366"),a=r("7b0b"),i=r("9bdd"),o=r("e95a"),s=r("50c4"),c=r("8418"),u=r("35a1");t.exports=function(t){var e,r,l,f,d,p,v=a(t),h="function"==typeof this?this:Array,m=arguments.length,g=m>1?arguments[1]:void 0,b=void 0!==g,y=u(v),w=0;if(b&&(g=n(g,m>2?arguments[2]:void 0,2)),void 0==y||h==Array&&o(y))for(e=s(v.length),r=new h(e);e>w;w++)p=b?g(v[w],w):v[w],c(r,w,p);else for(f=y.call(v),d=f.next,r=new h;!(l=d.call(f)).done;w++)p=b?i(f,g,[l.value,w],!0):l.value,c(r,w,p);return r.length=w,r}},5319:function(t,e,r){"use strict";var n=r("d784"),a=r("d039"),i=r("825a"),o=r("a691"),s=r("50c4"),c=r("577e"),u=r("1d80"),l=r("8aa5"),f=r("0cb2"),d=r("14c3"),p=r("b622"),v=p("replace"),h=Math.max,m=Math.min,g=function(t){return void 0===t?t:String(t)},b=function(){return"$0"==="a".replace(/./,"$0")}(),y=function(){return!!/./[v]&&""===/./[v]("a","$0")}(),w=!a((function(){var t=/./;return t.exec=function(){var t=[];return t.groups={a:"7"},t},"7"!=="".replace(t,"$<a>")}));n("replace",(function(t,e,r){var n=y?"$":"$0";return[function(t,r){var n=u(this),a=void 0==t?void 0:t[v];return void 0!==a?a.call(t,n,r):e.call(c(n),t,r)},function(t,a){var u=i(this),p=c(t);if("string"===typeof a&&-1===a.indexOf(n)&&-1===a.indexOf("$<")){var v=r(e,u,p,a);if(v.done)return v.value}var b="function"===typeof a;b||(a=c(a));var y=u.global;if(y){var w=u.unicode;u.lastIndex=0}var $=[];while(1){var x=d(u,p);if(null===x)break;if($.push(x),!y)break;var A=c(x[0]);""===A&&(u.lastIndex=l(p,s(u.lastIndex),w))}for(var S="",k=0,O=0;O<$.length;O++){x=$[O];for(var _=c(x[0]),j=h(m(o(x.index),p.length),0),I=[],C=1;C<x.length;C++)I.push(g(x[C]));var E=x.groups;if(b){var M=[_].concat(I,j,p);void 0!==E&&M.push(E);var P=c(a.apply(void 0,M))}else P=f(_,p,j,I,E,a);j>=k&&(S+=p.slice(k,j)+P,k=j+_.length)}return S+p.slice(k)}]}),!w||!b||y)},"5a34":function(t,e,r){var n=r("44e7");t.exports=function(t){if(n(t))throw TypeError("The method doesn't accept regular expressions");return t}},"9bdd":function(t,e,r){var n=r("825a"),a=r("2a62");t.exports=function(t,e,r,i){try{return i?e(n(r)[0],r[1]):e(r)}catch(o){throw a(t),o}}},"9fe1":function(t,e,r){"use strict";r("3243")},a15b:function(t,e,r){"use strict";var n=r("23e7"),a=r("44ad"),i=r("fc6a"),o=r("a640"),s=[].join,c=a!=Object,u=o("join",",");n({target:"Array",proto:!0,forced:c||!u},{join:function(t){return s.call(i(this),void 0===t?",":t)}})},a630:function(t,e,r){var n=r("23e7"),a=r("4df4"),i=r("1c7e"),o=!i((function(t){Array.from(t)}));n({target:"Array",stat:!0,forced:o},{from:a})},ab13:function(t,e,r){var n=r("b622"),a=n("match");t.exports=function(t){var e=/./;try{"/./"[t](e)}catch(r){try{return e[a]=!1,"/./"[t](e)}catch(n){}}return!1}},d28b:function(t,e,r){var n=r("746f");n("iterator")},d81d:function(t,e,r){"use strict";var n=r("23e7"),a=r("b727").map,i=r("1dde"),o=i("map");n({target:"Array",proto:!0,forced:!o},{map:function(t){return a(this,t,arguments.length>1?arguments[1]:void 0)}})},d879:function(t,e,r){"use strict";r.r(e);var n=function(){var t=this,e=t.$createElement,r=t._self._c||e;return r("div",{staticClass:"page-create"},[r("div",{staticClass:"container"},[r("div",{staticClass:"form-panel"},[r("a-form-model",{ref:"form",attrs:{model:t.form,"label-col":{span:5},"wrapper-col":{span:10},rules:t.rules},on:{submit:t.handleSubmit}},[r("a-form-model-item",{attrs:{label:"Name",prop:"name"}},[r("a-input",{attrs:{placeholder:t.$t("enter.automation.name")},model:{value:t.form.name,callback:function(e){t.$set(t.form,"name",e)},expression:"form.name"}})],1),r("a-form-model-item",{attrs:{label:"Action",prop:"type"}},[r("a-select",{attrs:{dropdownMatchSelectWidth:!1,placeholder:t.$t("choose.automation.action")},on:{change:t.onActionChange},model:{value:t.form.type,callback:function(e){t.$set(t.form,"type",e)},expression:"form.type"}},t._l(t.options.actions,(function(e){return r("a-select-option",{key:e.value,attrs:{value:e.value}},[t._v(" "+t._s(e.label)+" ")])})),1)],1),t.args.length?t._l(t.args,(function(e){return r("a-form-model-item",{key:e.name,attrs:{label:e.name}},[r("a-tooltip",[r("template",{slot:"title"},[t._v(" "+t._s(e.tips)+" ")]),"string"===e.type?r("a-input",{attrs:{placeholder:e.placeholder},model:{value:e.value,callback:function(r){t.$set(e,"value",r)},expression:"arg.value"}}):t._e(),"boolean"===e.type?r("a-switch",{model:{value:e.value,callback:function(r){t.$set(e,"value",r)},expression:"arg.value"}}):t._e()],2)],1)})):t._e(),r("a-form-model-item",{attrs:{label:"Target",prop:"target"}},[r("a-input",{attrs:{placeholder:t.$t("enter.automation.target.selector")},model:{value:t.form.target,callback:function(e){t.$set(t.form,"target",e)},expression:"form.target"}},[r("div",{attrs:{slot:"addonBefore"},slot:"addonBefore"},[t._v("@")])])],1),r("a-form-model-item",{attrs:{label:"Instructions","wrapper-col":{span:18}}},[r("code",{staticClass:"code"},[t._v(t._s(t.instructions))])]),r("a-form-model-item",{attrs:{label:"Pattern",prop:"pattern"}},[r("a-input",{attrs:{placeholder:t.$t("enter.automation.url.pattern")},model:{value:t.form.pattern,callback:function(e){t.$set(t.form,"pattern",e)},expression:"form.pattern"}})],1),r("a-form-model-item",{attrs:{label:"RunAt",prop:"runAt"}},[r("a-select",{attrs:{dropdownMatchSelectWidth:!1,placeholder:t.$t("choose.automation.runat")},model:{value:t.form.runAt,callback:function(e){t.$set(t.form,"runAt",e)},expression:"form.runAt"}},t._l(t.options.runAt,(function(e){return r("a-select-option",{key:e.value,attrs:{value:e.value}},[t._v(" "+t._s(e.label)+" ")])})),1)],1),r("a-form-model-item",{attrs:{label:"Video",prop:"video"}},[r("a-textarea",{attrs:{placeholder:t.$t("enter.automation.video"),autoSize:{minRows:2}},model:{value:t.form.video,callback:function(e){t.$set(t.form,"video",e)},expression:"form.video"}})],1),r("a-form-model-item",{attrs:{label:"Intro",prop:"intro","wrapper-col":{span:18}}},[r("a-icon",{class:{"is-active":t.inpreview},attrs:{type:"read"},on:{click:t.onPreviewClick}}),r("a-textarea",{directives:[{name:"show",rawName:"v-show",value:!t.inpreview,expression:"!inpreview"}],attrs:{placeholder:t.$t("enter.automation.intro"),autoSize:{minRows:2}},model:{value:t.form.intro,callback:function(e){t.$set(t.form,"intro",e)},expression:"form.intro"}}),t.inpreview?r("div",{staticClass:"intro-preview",domProps:{innerHTML:t._s(t.introPreview)}}):t._e()],1),r("a-form-model-item",{attrs:{"wrapper-col":{span:10,offset:5}}},[r("a-button",{attrs:{type:"primary","html-type":"submit",disabled:t.submitting}},[t._v(t._s(t.submitBtnText))])],1)],2)],1)])])},a=[],i=r("5530");function o(t,e){(null==e||e>t.length)&&(e=t.length);for(var r=0,n=new Array(e);r<e;r++)n[r]=t[r];return n}function s(t){if(Array.isArray(t))return o(t)}r("a4d3"),r("e01a"),r("d3b7"),r("d28b"),r("3ca3"),r("ddb0"),r("a630");function c(t){if("undefined"!==typeof Symbol&&null!=t[Symbol.iterator]||null!=t["@@iterator"])return Array.from(t)}r("fb6a"),r("b0c0");function u(t,e){if(t){if("string"===typeof t)return o(t,e);var r=Object.prototype.toString.call(t).slice(8,-1);return"Object"===r&&t.constructor&&(r=t.constructor.name),"Map"===r||"Set"===r?Array.from(t):"Arguments"===r||/^(?:Ui|I)nt(?:8|16|32)(?:Clamped)?Array$/.test(r)?o(t,e):void 0}}function l(){throw new TypeError("Invalid attempt to spread non-iterable instance.\nIn order to be iterable, non-array objects must have a [Symbol.iterator]() method.")}function f(t){return s(t)||c(t)||u(t)||l()}function d(t){if(Array.isArray(t))return t}function p(t,e){var r=null==t?null:"undefined"!==typeof Symbol&&t[Symbol.iterator]||t["@@iterator"];if(null!=r){var n,a,i=[],o=!0,s=!1;try{for(r=r.call(t);!(o=(n=r.next()).done);o=!0)if(i.push(n.value),e&&i.length===e)break}catch(c){s=!0,a=c}finally{try{o||null==r["return"]||r["return"]()}finally{if(s)throw a}}return i}}function v(){throw new TypeError("Invalid attempt to destructure non-iterable instance.\nIn order to be iterable, non-array objects must have a [Symbol.iterator]() method.")}function h(t,e){return d(t)||p(t,e)||u(t,e)||v()}function m(t){return d(t)||c(t)||u(t)||v()}r("a15b"),r("bf19"),r("ac1f"),r("5319"),r("159b"),r("1276"),r("d81d"),r("4de4"),r("99af"),r("7db0");var g=r("267e");r("2ca0");function b(){return JSON.parse(JSON.stringify(g["a"]))}function y(){return{name:"",intro:"",pattern:"",target:"body",type:"",runAt:1,video:""}}function w(t){return{name:[{required:!0,message:t.$t("enter.automation.name")}],type:[{required:!0,message:t.$t("choose.automation.action")}],target:[{required:!0,message:t.$t("enter.automation.target.selector")}],pattern:[{required:!0,message:t.$t("enter.automation.url.pattern")}],video:[{validator:function(e,r,n){r?r.startsWith("<iframe")?n():n(new Error(t.$t("invalid.video"))):n()}}]}}var $=r("b1c8"),x=r("1f57"),A=r("7eda"),S={name:"AutomationCreate",data:function(){var t=this.$route.params.id;return{id:t,mode:t?"update":"create",options:{actions:g["a"],runAt:g["c"]},actionConfigs:b(),form:y(),rules:w(this),args:[],inpreview:!1,submitting:!1,introPreview:""}},computed:{instructions:function(){var t=this.getFullAction(),e=this.form.target;return[t,"@",e].join("")},submitBtnText:function(){return"create"===this.mode?this.$t("create"):this.$t("update")}},methods:{isAuthor:function(t){var e=Object(x["a"])();return e.id===t.objectId},loadData:function(){var t=this;$["b"].item(this.id).then((function(e){var r=e.toJSON();t.isAuthor(r.author)?t.handleData(r):t.$message.warn(t.$t("permission.denied"),(function(){t.$router.replace("/")}))}))},handleData:function(t){var e=t.name,r=t.intro,n=t.pattern,a=t.type,i=t.video,o=t.instructions,s=t.runAt;Object.assign(this.form,{name:e,intro:r,pattern:n,type:a,video:i,runAt:s}),this.updateArgs(a);var c=this.parseInstructions(o),u=c.target,l=c.args;this.form.target=u,this.setArgs(l)},setArgs:function(t){this.args.forEach((function(e){Object.prototype.hasOwnProperty.call(t,e.name)&&(e.value=t[e.name])}))},getExecOptions:function(){var t=arguments.length>0&&void 0!==arguments[0]?arguments[0]:[],e={};return t.forEach((function(t){var r=t.split("!"),n=m(r),a=n[0],i=n.slice(1);i.length?1===i.length?e[a]="true"===i||"false"===i?"true"===i:i[0]:e[a]=i:e[a]=!0})),e},parseInstructions:function(t){var e=t.split("@"),r=h(e,2),n=r[0],a=r[1],i=n.split("^"),o=m(i),s=o[0],c=o.slice(1);return{action:s,args:this.getExecOptions(c),target:a}},getFullAction:function(){var t=this.form.type,e=this.args;if(this.args.length){var r=e.filter((function(t){return t.value!==t.defaultValue})).map((function(t){return[t.name,t.value].join("!")}));return[t].concat(f(r)).join("^")}return t},reset:function(){this.form=y(),this.actionConfigs=b(),this.args=[]},create:function(t){var e=this;return Object($["a"])(t).then((function(){e.submitting=!1,e.$message.success(e.$t("create.ok")),e.reset()})).catch((function(){e.$message.error(e.$t("create.error"))}))},update:function(t){var e=this;return $["b"].updateOne(this.id,t).then((function(){e.submitting=!1,e.$message.success(e.$t("update.ok"))})).catch((function(){e.$message.error(e.$t("update.error"))}))},submit:function(){var t=Object.assign({},this.form);delete t.target;var e=Object(i["a"])(Object(i["a"])({},t),{},{instructions:this.instructions});this.submitting=!0,"create"===this.mode?this.create(e):this.update(e)},handleSubmit:function(t){var e=this;t.preventDefault(),this.$refs.form.validate((function(t){t&&e.submit()}))},updateArgs:function(t){var e=this.actionConfigs.find((function(e){return e.value===t}));this.args=e&&e.args||[]},onActionChange:function(t){this.updateArgs(t)},onPreviewClick:function(){this.inpreview=!this.inpreview,this.inpreview&&(this.introPreview=Object(A["a"])(this.form.intro))}},mounted:function(){"update"===this.mode&&this.loadData()}},k=S,O=(r("4478"),r("9fe1"),r("2877")),_=Object(O["a"])(k,n,a,!1,null,"78b0bdbf",null);e["default"]=_.exports},e01a:function(t,e,r){"use strict";var n=r("23e7"),a=r("83ab"),i=r("da84"),o=r("5135"),s=r("861d"),c=r("9bf2").f,u=r("e893"),l=i.Symbol;if(a&&"function"==typeof l&&(!("description"in l.prototype)||void 0!==l().description)){var f={},d=function(){var t=arguments.length<1||void 0===arguments[0]?void 0:String(arguments[0]),e=this instanceof d?new l(t):void 0===t?l():l(t);return""===t&&(f[e]=!0),e};u(d,l);var p=d.prototype=l.prototype;p.constructor=d;var v=p.toString,h="Symbol(test)"==String(l("test")),m=/^Symbol\((.*)\)[^)]+$/;c(p,"description",{configurable:!0,get:function(){var t=s(this)?this.valueOf():this,e=v.call(t);if(o(f,t))return"";var r=h?e.slice(7,-1):e.replace(m,"$1");return""===r?void 0:r}}),n({global:!0,forced:!0},{Symbol:d})}},fb6a:function(t,e,r){"use strict";var n=r("23e7"),a=r("861d"),i=r("e8b5"),o=r("23cb"),s=r("50c4"),c=r("fc6a"),u=r("8418"),l=r("b622"),f=r("1dde"),d=f("slice"),p=l("species"),v=[].slice,h=Math.max;n({target:"Array",proto:!0,forced:!d},{slice:function(t,e){var r,n,l,f=c(this),d=s(f.length),m=o(t,d),g=o(void 0===e?d:e,d);if(i(f)&&(r=f.constructor,"function"!=typeof r||r!==Array&&!i(r.prototype)?a(r)&&(r=r[p],null===r&&(r=void 0)):r=void 0,r===Array||void 0===r))return v.call(f,m,g);for(n=new(void 0===r?Array:r)(h(g-m,0)),l=0;m<g;m++,l++)m in f&&u(n,l,f[m]);return n.length=l,n}})}}]);
//# sourceMappingURL=create.f175e520.js.map